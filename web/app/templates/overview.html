<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="static/css/overview.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    
    <script src="/static/js/scripts.js"></script>
     <script src="https://code.jquery.com/jquery-3.5.0.js"></script>
    <!-- <script src="https://cdn.tailwindcss.com"></script> -->
    <title>Overview</title>
</head>

<body>
    <nav>
        <a class="active">Computer Science CMU</a>
        <ul class="menu">
            <li class="list">
                <a href="javascript:void(0);" onclick="ShowPopupMenu();"><i class="bi bi-list"></i></a>
                <ul class="popup-menu" id="popupMenu">
                    <li><a href="/overview">ภาพรวม/Overview</a></li>
                    <li><a href="/subject_credit">ภาพรวมหลักสูตร/Subjects</a></li>
                    <li><button class="Logout" type="button"><a href="/user/signout_student" class="btn btn-secondary">Sign Out</a></button></li>
                </ul>
            </li>
        </ul>
    </nav>
    <div class="info">
        <p class="text">
            <span class="span">ชื่อ - นามสกุล / Name - Surname: {{ session['user']['first_name'] }} {{ session['user']['last_name'] }}</span><br>
            <span class="span">รหัสนักศึกษา / Student ID: {{ session['user']['_id'] }}</span><br>
            <span id="tea" class="span">อาจารย์ที่ปรึกษา / Advisor:</span>
        </p>
    </div>
    <!-- link ไฟล์ excel ยังทำไม่ได้ -->
    <div class="temp">Download excel template</div> 
    <div class="plans">แผนการศึกษา: {{ session['user']['study_plan'] }}</div>
    <button class="Bplan" type="button">Choose</button>
    <div id="GPAA" class="gpa">Cumulative GPA :</div>
    <!-- จะทำเป็น link กดไป folder ในคอม แต่ทำไม่ได้ -->
    <div class="impex">Import ข้อมูลการลงทะเบียนโดย excel</div> 
    <div class="study">Overview
        <div class="y1">Year 1
            <div id="loop"class="board">
                
            </div>
            <!--<button class="edit" type="button">Edit</button>-->
        </div>
        <div class="y2">Year 2
            <div id="loop2"class="board">
                
            </div>
            <!--<button class="edit" type="button">Edit</button>-->
        </div>
        <div class="y3">Year 3
            <div id="loop3"class="board">
                
            </div>
            <!--<button class="edit" type="button">Edit</button>-->
        </div>
        <div class="y4">Year 4
            <div id ="loop4"class="board">
                
            </div>
            <!--<button class="edit" type="button">Edit</button>-->
        </div>
    </div>

    <script>
        console.log("*******")
        
        console.log("*******")
        function displayData(data){
            console.log(data[0]["subject_id"]);
            console.log(data[0]);
            console.log(data.length)
            console.log("TTTTTTTTTTTTTT")
            
            var container = document.getElementById("loop");
            var html = '';
            var j = 0;
            for(var i = 0; i < data.length; i++){
                j++;
                var num;
                if(data[i]["grade"] == "4"){
                    num = "A"
                }
                if(data[i]["grade"] == "3.5"){
                    num = "B+"
                }
                if(data[i]["grade"] == "3"){
                    num = "B"
                }
                if(data[i]["grade"] == "2.5"){
                    num = "C+"
                }
                if(data[i]["grade"] == "2"){
                    num = "C"
                }
                if(data[i]["grade"] == "1.5"){
                    num = "D+"
                }
                if(data[i]["grade"] == "1"){
                    num = "D"
                }
                if(data[i]["grade"] == "0"){
                    num = "F"
                }
                
                html+= `<div class='sid'><span class="left-content">${data[i]["subject_id"]}</span><span class="middle-content">Grade:</span><span class="right-content">${num}</span></div>`; 
            }
            for(var k = 0; k <16- j; k++){
                html+= `<div class='sid'><span class="left-content">&nbsp;</span><span class="middle-content">&nbsp;</span><span class="right-content">&nbsp;</span></div>`; 

            }
            container.innerHTML = html;
            return 2;
        }
        function displayData2(data){
            console.log(data[0]);
            console.log(data.length)
            
            var container = document.getElementById("loop2");
            var html = '';
            
            var j = 0;
            for(var i = 0; i < data.length; i++){
                j++;
                var num;
                if(data[i]["grade"] == "4"){
                    num = "A"
                }
                if(data[i]["grade"] == "3.5"){
                    num = "B+"
                }
                if(data[i]["grade"] == "3"){
                    num = "B"
                }
                if(data[i]["grade"] == "2.5"){
                    num = "C+"
                }
                if(data[i]["grade"] == "2"){
                    num = "C"
                }
                if(data[i]["grade"] == "1.5"){
                    num = "D+"
                }
                if(data[i]["grade"] == "1"){
                    num = "D"
                }
                if(data[i]["grade"] == "0"){
                    num = "F"
                }
                
                html+= `<div class='sid'><span class="left-content">${data[i]["subject_id"]}</span><span class="middle-content">Grade:</span><span class="right-content">${num}</span></div>`; 
            }
            for(var k = 0; k <16- j; k++){
                html+= `<div class='sid'><span class="left-content">&nbsp;</span><span class="middle-content">&nbsp;</span><span class="right-content">&nbsp;</span></div>`; 

            }
            container.innerHTML = html;
            return 3;
            
        }
        function displayData3(data){
            console.log(data[0]);
            console.log(data.length)
            
            var container = document.getElementById("loop3");
            var html = '';

            var j = 0;
            for(var i = 0; i < data.length; i++){
                j++;
                var num;
                if(data[i]["grade"] == "4"){
                    num = "A"
                }
                if(data[i]["grade"] == "3.5"){
                    num = "B+"
                }
                if(data[i]["grade"] == "3"){
                    num = "B"
                }
                if(data[i]["grade"] == "2.5"){
                    num = "C+"
                }
                if(data[i]["grade"] == "2"){
                    num = "C"
                }
                if(data[i]["grade"] == "1.5"){
                    num = "D+"
                }
                if(data[i]["grade"] == "1"){
                    num = "D"
                }
                if(data[i]["grade"] == "0"){
                    num = "F"
                }
                
                html+= `<div class='sid'><span class="left-content">${data[i]["subject_id"]}</span><span class="middle-content">Grade:</span><span class="right-content">${num}</span></div>`; 
            }
            for(var k = 0; k <16- j; k++){
                html+= `<div class='sid'><span class="left-content">&nbsp;</span><span class="middle-content">&nbsp;</span><span class="right-content">&nbsp;</span></div>`; 

            }
            container.innerHTML = html;
        }
        function displayData4(data){
            console.log(data[0]);
            console.log(data.length)
            
            var container = document.getElementById("loop4");
            var html = '';

            var j = 0;
            for(var i = 0; i < data.length; i++){
                j++;
                var num;
                if(data[i]["grade"] == "4"){
                    num = "A"
                }
                if(data[i]["grade"] == "3.5"){
                    num = "B+"
                }
                if(data[i]["grade"] == "3"){
                    num = "B"
                }
                if(data[i]["grade"] == "2.5"){
                    num = "C+"
                }
                if(data[i]["grade"] == "2"){
                    num = "C"
                }
                if(data[i]["grade"] == "1.5"){
                    num = "D+"
                }
                if(data[i]["grade"] == "1"){
                    num = "D"
                }
                if(data[i]["grade"] == "0"){
                    num = "F"
                }
                
                html+= `<div class='sid'><span class="left-content">${data[i]["subject_id"]}</span><span class="middle-content">Grade:</span><span class="right-content">${num}</span></div>`; 
            }
            for(var k = 0; k <16- j; k++){
                html+= `<div class='sid'><span class="left-content">&nbsp;</span><span class="middle-content">&nbsp;</span><span class="right-content">&nbsp;</span></div>`; 

            }
            container.innerHTML = html;
        }
        function showteacher(data){
            
            var a= data[0]["first_name"];
            var b= data[0]["last_name"];
            console.log(a);
            var html = '';
            var container = document.getElementById("tea");
            html += `อาจารย์ที่ปรึกษา / Advisor: ${a} ${b}`;
            container.innerHTML = html;

        }
        function showgrade(data){
            console.log("11111111111");
            var a = data[0]["Grade"];
            console.log(typeof(a));
            console.log("11111111111");
            var container = document.getElementById("GPAA");
            var html = a.toFixed(2);
            container.innerHTML = `Cumulative GPA : ${a.toFixed(2)}`;;

        }
        $(document).ready(function () {
            $.getJSON("/data1", function (data) {
                // Call the displayData function to update the HTML with the received data
                displayData(data);
            });
            $.getJSON("/data2", function (data) {
                // Call the displayData function to update the HTML with the received data
                displayData2(data);
            });
            $.getJSON("/data3", function (data) {
                // Call the displayData function to update the HTML with the received data
                displayData3(data);
            });
            $.getJSON("/data4", function (data) {
                // Call the displayData function to update the HTML with the received data
                displayData4(data);
            });
            $.getJSON("/tadvisee", function (data) {
                // Call the displayData function to update the HTML with the received data
                showteacher(data);
            });
            $.getJSON("/avggrade", function (data) {
                // Call the displayData function to update the HTML with the received data
                showgrade(data);
            });
        });

        function ShowPopupMenu() {
            let popupMenu = document.getElementById('popupMenu');

            if (popupMenu.style.display === 'none') {
                popupMenu.style.display = 'block';
            } else {
                popupMenu.style.display = 'none';
            }
        }
    </script>
</body>

</html>